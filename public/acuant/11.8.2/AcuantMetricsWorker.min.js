"use strict";importScripts("AcuantMetricsService.min.js"),AcuantMetricsModule().then((e=>{function r(e,r){let t={func:"metrics"};e>=0&&r>=0?(t.sharpness=e,t.glare=r):t.error=e<-.5&&e>-1.5?"Runtime error":e<-1.5&&e>-2.5?"Metrics did not return OK":"Unknown Error Occured",postMessage(t)}function t(e,r){let t={func:"moire"};e>=0&&r>=0?(t.moire=e,t.moireraw=r):t.error=e<-.5&&e>-1.5?"Runtime error":e<-1.5&&e>-2.5?"Moire did not return OK":"Unknown Error Occured",postMessage(t)}function n(r){null!=r&&(e._free(r),r=null)}function i(r){let t=e._malloc(r.length*r.BYTES_PER_ELEMENT);return e.HEAPU8.set(r,t),t}onmessage=a=>{if(a&&a.data)if("metrics"===a.data.func){let t=a.data.data;if(t.imgData&&t.width&&t.height){let a=i(t.imgData);const o=e.ccall("acuantMetrics","number",["number","number","number"],[a,t.width,t.height]);let s=[];for(let r=0;r<2;r++)s[r]=e.getValue(o+4*r,"float");n(a),r(s[0],s[1])}else console.error("missing params"),r(-1,-1)}else if("moire"===a.data.func){let r=a.data.data;if(r.imgData&&r.width&&r.height){let a=i(r.imgData);const o=e.ccall("acuantMoire","number",["number","number","number"],[a,r.width,r.height]);let s=[];for(let r=0;r<2;r++)s[r]=e.getValue(o+4*r,"float");n(a),t(s[0],s[1])}else console.error("missing params"),t(-1,-1)}else console.error("called with no func specified")},postMessage({metricsWorker:"started"})}));