#!/usr/bin/env ruby
# frozen_string_literal: true

require 'yaml'

if ARGV.empty?
  raise 'Pass YAML files as arguments. Example: `scripts/yaml_characters path/to/example.yml`'
end

def sanitize(string)
  string.gsub(/<.+?>/, '').gsub(/%{.+?}/, '').gsub(/[\n\r]/, '')
end

characters = ARGV.flat_map do |file|
  strings = YAML.load_file(file).values.flatten
  joined_string = strings.join('')
  sanitized_string = sanitize(joined_string)
  sanitized_string.chars.to_a
end.uniq.sort.join('')

STDOUT.puts characters
