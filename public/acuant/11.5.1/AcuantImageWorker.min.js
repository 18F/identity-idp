"use strict";importScripts("AcuantImageService.min.js"),AcuantImageModule().then((e=>{let r=e.addFunction(a,"viiiii"),t=e.addFunction(i,"viiiiiiiii");function a(r,t,a,i,n){let c={func:"crop"};if(a>=0){const o=new ArrayBuffer(t);let s=new Uint8Array(o);s.set(e.HEAPU8.subarray(r,r+t),0),c.imgData=s,c.width=a,c.height=i,c.type=n}else switch(a){case-1:c.error="Runtime error.";break;case-2:c.error="Detect (for cropping) did not return OK";break;case-3:c.error="Crop did not return OK";break;default:c.error="Unknown Error Occured"}c&&c.imgData&&c.imgData.buffer?postMessage(c,[c.imgData.buffer]):postMessage(c)}function i(e,r,t,a,i,n,c,o,s){let u={func:"detect"};if(r>=0)u.type=e,u.x1=r,u.y1=t,u.x2=a,u.y2=i,u.x3=n,u.y3=c,u.x4=o,u.y4=s;else switch(r){case-1:u.error="Runtime error.";break;case-2:u.error="Detect did not return OK";break;default:u.error="Unknown Error Occured"}postMessage(u)}function n(r){null!=r&&(e._free(r),r=null)}function c(r){var t=e._malloc(r.length*r.BYTES_PER_ELEMENT);return e.HEAPU8.set(r,t),t}onmessage=o=>{if(o&&o.data)if("crop"===o.data.func){let t=o.data.data;if(t.imgData&&t.width&&t.height){let a=c(t.imgData);e.ccall("acuantCrop",null,["number","number","number","number"],[a,t.width,t.height,r]),n(a)}else console.error("missing params"),a(-1,-1,-1,-1)}else if("detect"===o.data.func){let r=o.data.data;if(r.imgData&&r.width&&r.height){let a=c(r.imgData);e.ccall("acuantDetect",null,["number","number","number","number"],[a,r.width,r.height,t]),n(a)}else console.error("missing params"),i(-1,-1,-1,-1,-1,-1,-1,-1,-1)}else console.error("called with no func specified")},postMessage({imageWorker:"started"})}));