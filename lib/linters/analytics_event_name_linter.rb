module RuboCop
  module Cop
    module IdentityIdp
      class AnalyticsEventNameLinter < RuboCop::Cop::Cop
        RESTRICT_ON_SEND = [:track_event]

        # DO NOT ADD TO THIS LIST OR YOU WILL MAKE A KITTEN CRY!
        LEGACY_EVENT_NAMES = %w[
          fa2f67ec7adea3857381bd13a0ad040b
          c3060a6e79cef00465c345beee596b9c
          625c1094f58a9bdbdf169c47318f6468
          074a73eda0ab8d609e200a5b708a23e4
          1ddace4b9020f848cdba79ecf5d450a6
          49a101345d1955ce0a6c0675d4bba11c
          2e716303c3dd0d2e7ee67df58ef60c9b
          feb248324c50554c4f1ca9d058929a84
          774c2e9ce563c27269c3b3d5cc771561
          fcc9f02f9f00caefb124b8c712fc5911
          ef39c7c23633335592c8474e7224b701
          67a62540527276767b4ca51e3eca4b93
          452df9427864feca328aa78c8f41ed6d
          3d4c642dd143da4d0b6b6eb7f7e6130b
          9f054382954ff83afb6e8bb6821646fc
          42a4beb0b3519d0140f238def041dc3f
          8c7f423109d55e32bc6d9b81b786bfdd
          ca5c2439f159a95b02c8e0b9353d68e9
          1f86f1925a44c5bc8ca670de82f0c3ed
          3f5dcb735d1e0c8af2f0756440cc5877
          80eb9a6a91635f72b54c71c9835319f0
          c6c20d3973bb1f6031e077aa92003fa3
          df508f2f993ffc4e040cdb128670c1b8
          06e295f80d583b3c09040834416206d1
          9479ccc4ac44047198855286368e67d9
          6b12f5a14189ea47a389eb18e2fce9f4
          236bf382afcf0f251606cb0e7815de4c
          b63a8400322ad43763543bde172022cc
          58000bf921a07aa2da7b467f969922ab
          5045eea1ff376046091a0c754636bddc
          9513de63825ffc8833f5bba94cd65876
          ef6d1270a1714bf1a9a3aa4ff150bcc7
          d9113fceca8c24d83bf08779254d0853
          394fda26a048c4146b2bb7cc43568d6f
          3fce36d69ae4596b43ba2d533abe5c73
          065996050c0a16bc03bebb1cc6615d9e
          7fa7cd1008775455a650c35add02aec2
          27e2f1a6266eda0e92c84099f80af87a
          63ecb4ebccfe5b21322f7f16ac55b4a0
          55860c06ed5b524296329d00857bc204
          d97a3d7bbd5d11967e24bd1f19255d78
          c25e0a30b40912daa130196c588f104f
          a6b5bd05d701b40e871bebb4648fc05a
          05bccf5a8c617e8e1d5e1be8f51a2ac4
          c57b9cbba8d20be09affec36b3d89ada
          86bb24756d26165eadf6c8487f80fb15
          b89b4f177edc1179ae73fce017528063
          df354b78271654d02917994d98845839
          bb3e94d17ffdbf93025ed645ccb65561
          cb04f63064bae2fba5d568f934e03f9e
          b03ccdef708ac5e85d0c429585ada46e
          a15c306c71e605d0beb63ad622607173
          5c531e1595db5864511faeb1e4833e22
          9e2d5e538249620759458cf29e4d9415
          31aa7e226faf274f4c8b4fdf9074de60
          22cd3d149f65de6587a8290d5216889d
          414caa66a049a9baeeb49c15099c74bd
          bc99baf6dd1ded3ebc69140a8c2cf9d5
          d4389ec44c07f3217aac4b6471101f43
          889b2f9701d430d3eeeb797f3da5ac3f
          0015f2fe01ad6e864e96ffb1906104e4
          d618afeb2ce1dc55c152267a0bd91635
          6b24568cd9d58d4d8180d6845cea0061
          a9c1d15d87d4fdb46e4dd071893a07f4
          f04807b68553adb7aa8aec0661f3a2f9
          319b83c51eddaa4a206d8ef8ee4ec263
          a381ca6495ae4915670f5ead5afd8b1f
          b49b3a2aa31b75fff5b6e3d783176ccb
          e39312c6ce1364ab3f1e6c64ac6346ee
          fe5ffd3530c0c6a5f3acf3bca8cef061
          404a2d723ec92010301a82abf9106ec2
          0b503052f76aeefebaf64aa023d19d5c
          6ab602d229c377641acddead85cd6b38
          f075ee0879c95f4042708a5c7a0523c7
          0a6e7176ca7e378a7543845452dc1b58
          1a8ab1684cb7b5b4ecf2e1a8293b0a6e
          836a2d1e42614b306275a4108b807cc9
          ae328e835300cfe32d52b08d32ffee6a
          491ca0e8a0248615d31cf2f44ac6deb2
          73f8b14a8d62a2c9747c13ed0b619da8
          1c753ed63b0e58d42261888d1170d973
          74ace4e17906c7c929167684c38112e1
          f92f040803996b5d0ff175bba1dc58c1
          045dbb2e38273a66c151d4b06c8e27d4
          fad0d5b684ee6477ff18f29c8bef4069
          e64f0c86b53098d8883c0bd1e5d84ba6
          a3d2374415c8ed67cf54734b3a939bc3
          8d04135e3ed8b9f86c0bae05d24a20f4
          8c14c0abd7cc6e2c5837269ebe905ecf
          fd8ead89329b3874561a39ff9bdcd2bc
          672dbfadf665d8ab27be0a0854e222f8
          7e9900f0285d36e43310d6821a7b79fc
          2d1e4d29cf68de8bbc61906dabf4a6d4
          294e3ae46239b972e2b216aa85dda551
          cf1935052eccba97fa66461212839a39
          4d95c639b892d2d63dd6cea40a5519ff
          607bfb73e57f495f3be61d1ba080fa8b
          1d43091a248d6c9420a2e19a447be865
          d14eb4dc9bb839983539261cc3c09fe2
          b8dabbe2fe4328469ce82482ec2dcafd
          3891860a9dfcf51ad0dfec5e0eca9d7b
          942fe5d36e650f17f6584fdfbd97a1b0
          c62565c63f1416f00a22a7e45560a345
          ba49cf43f06acc537b3ae65c1ee103bc
          c3aadb61a94a27142a59e23b0f5e0733
          8283e0d3eee1627c05e28d5532ff90be
          bbb114a86ecb98004597cda2e1da0c83
          42693b99d786e8146c4572216590265f
          5abf6e8a6e619827e7d6119688989644
          c28802a4a21b3d1613e2f6395bd66e63
          9d17d30c5bdd8ef2a49604de7140e50f
          b702e7e66023835ca5cf32d5238002d4
          27737a0aa5a49d21015f43fda7238d48
          92d1e4260661d3c3666639128d1aeabd
          47e21a2a52a00f498be17a7decc698dc
          ef37839c8e436c788a9e8d129cdc2bd1
          a53ca410693bc43f8f1ba1752252ec4d
          24b7a8752120240351dd8c0d415b1c4f
          b83531be9a04660b709f9325c6184473
          f9bbcd1410484ff181c61b0ca136f0a1
          ead592cad715332a609643febdbc868e
          c08f2173125c2b8daa0963ba3e7c8364
          ceeba19818a6aaf5511dea747901f9c4
          6cb85ec212178df009101a7080bd079d
          e8fa955884bc655fb6a965435637fa45
          dbd33b6738aa8c349639f4a334a213f9
          e4c93139ea64938d9e2bf420ac1460e1
          f7ba0dbb81cb6d2a12c2efa5b9cb9eec
          166d9f9e8eb0831ae0763b42aeb01001
          2fc097350b2310b5cbe56c37781a939e
          7f64dec66e5a98f754a1e0fa4e08fee0
          08057aef2662fb69fe3b9011586382e6
          a86dcfa7be3495732d37b82d59e0754b
          2139f3c631c3547d80b899bad59e6bd9
          91cf7654d3d30b63d1383ab55e37f17a
          ca4ff043adb58bade802b1f20c9b3b50
          73eba23abe09e0f4d963ce70eccf5fe6
          bbc673d351ecdbfb3886931bacbca244
          612d6afa5348f973c79a0eb8eeeb338b
          f70e428668f076a836678c617f3a02de
          7e592da0f0c893bc7a17b307ea53e7a7
          2411bc8d7a3813dd3e14e094fff68ecf
          e18400e3dc2482a5cf9aad00bede5c88
          c55f8e7d526de8be5d4ac8f6eaba7324
          f703c3b75212ef97aa45b4e0d7585779
          b0c6e3cd76c49d68d7b6433e341bc0d1
          feb0ae0ed67d3d257aef2009d4973fe6
          c0d19956ada1b9d348d2871c981ad76b
          68d050cb88b19daddd1558a9498b97f7
          01407b5ba38f8e7c79328a28da3545ac
          48b9d7b56bef9cb33430083c95829db6
          e54cadff86fe974627ec48d89ec1578d
          c445688e175a746fd9ce6b4a7a9dec62
          0480a6a47d3f40d5f5d9c6f290335fba
          de202d081576d197df05cc90ee54e286
          4f640acaacb7c2070ea044328426000c
          833bb3b5a398987aaa237308e8bcdb4d
          2714ab3de6d1c4d4fec03091346c4b1a
          cc442c9298147355248c1ce1e0438fda
          ef942787e04f3a5e353ba7150e18eb45
          3149e014304a6a1e7469995c31675588
          f1b713a97db95083f31c9807c0308d7a
          66566d79ec5409ea2fd857456a160983
          12cfe9926b6529069a9f0ab6ad540d16
          ae7bf19fbf907aaa33184cf8fe02b78d
          dec4ba9ce3a2d2c6999395623c709e40
          78944913ac52867ca067fb1f7077d47a
          50c890f61c5977f1c2f64ba95825329a
          cf1a116ae511c094c2f05da6d11b5dff
          5af8fb2e36b9e6f0edb6a8a9f7f8f2f3
          6d3e841ab2b47201406f0ecd4fe734c6
          b9c1844e7dccb6b669fc6613fa690100
          81fd71b41632523da8b7731cbf0f38a8
          2ccfec65febfd6b873ab1300a5a04978
          e4644bbcd6165c415389903d6ba37d22
          c18ae3724208062fffbf7c497ef61896
          3a63d7849222e11d0ef12c33b994b3b2
          7187c0ad8b7a9bdd43f9a7415adb1ea2
          f4fedd8eec836aa1dc84ac2bad8aeb2a
          965aa71643006dc3eea67e36cbd48fbe
          6ebd7033a1df6a5291201d91e6b4ab5f
          a01a37ce9c066e51ec4361bcc68b8abe
          dc98bdc68c244a77049d4a6c9b01f093
          a1b33c69a061f7f2fbd494a018d55c96
          23b7753404bc8a6ab8ad89bcbf02479e
          8506e38518733cbda3c5f9936a664077
          fa5c68ecba6b7d0dda65ed3a6c8b2267
          14260817091db87d4eb55cf93db59cb4
          f064ba355a43861f6e1e1e9a7b90b05a
          42b5269e5256f9a06574faad24943452
          9dfec94297af65fafa65bb15684c4efe
          2fc3f5113ce384ea4f4baec6198f9632
          b82e7497f089e73976738b6fe08ca99a
          50a82ce0f61915d8a725dc56b89369dc
          30a6e9ddd5982b449dfb3b3d09f6a1f7
          1e9de28069a51db8d65fd63093ca376a
          9083a035b2a32c006b827f7f3a4800eb
          fbf06db8977281ea150fb8dfbca0db29
          66284924e2d418ccfc24a5b6cee48d8e
          0a79346f18ba28b037aefdb66ac0c28a
          80774c219d03ea4298d7ad956e20c6aa
          3385dfe83e7448234d0cf164ecb00d2b
          ad5c3f45cdd6342d1823e2dca977dd4c
          cc7c8b279c5969a0aaf750470690cab3
          3a1628ad27ad08b683951291fdce12a8
          116e9dd2bbb6ce07830b939a0857a483
          62d599980f3a5834252e9a036b797a96
          a06d7aec8fea2b0bbb7b90dd8d61e046
          059814201b4a83c5e4a43f297942d085
          8557ddc9369369210f963fee3896cf7c
          4412ef4243e701240835d71dc6c4d70b
          245cc6b5a975e3d2bc0ddc59fc5569fb
          780d1154fe7658e7165fffa5d8286e8c
          075565e64e93d418309e628b578de8c3
          05734b0441a902996955e2f35d30d55a
          b4d3a07eca21d2f8e7184aca73cb5ffd
          1db82faf6958ce5995681b0efc649245
          0e27f2a9091ba5b8bb91529b1afc5362
          9543306e805e19f223f598e7a61f1660
          6646e279f45c121d8c04ff3a6385017e
          8b861cf6debdd9372d4ee16ebd62b681
          7cbfab24cd649e816b1567684622d3a4
          e2ba0485e1998756fef672c71a31e55b
          e3773e87c267d21afb3f190b75ee3f14
          acd0dbefde53faea039e8d49686626cd
          7dddb36cb45fa935faccc08a6b964d33
          5fe88d253e1c35690024a7fafb2bbd00
          e4d17d32541d144ba40a71f43890d4ce
          79e09c5dbf3722c220157b544dc05add
          377c0c968e09b0ec4546447230d25328
          3cf0c2289639fc0d44724e7bd3e364dd
          2cd46848260a4b0e52352f687270d6c0
          beefc430ce1eae32d8bfaec8b5f394a0
          452be674a6e125ff59d3ed4d8c102ad7
          3cf9b87b65df53ad4a4a677018a6ed98
          73769811bdc1b5e8f42bc7156844a8aa
          b78faa8e507f09b7e64d0bda3c199957
          cec5d15397b52ab50dced105dff44faf
          0957a56649650d5c4d4041b204928652
          a1769cf5aacf040ca8d13f585cdeba85
          eabc9495e3931b743fea9ddc35dbda76
          e4173d8b436e2137929fdb089a01be9c
          fa5332bf24780a0e5d97c92cb6685c20
          f94ad46e34cb1ef634dc56d0e07fac42
          96db2d8c30e9619bb2b7f6c405d49d23
          95d1a06b2eb9d67cbe8a5748ca46b7ae
          1aa4b09d378ba47b8c5cfb601e669bd2
          ccbc838eb8c5cdfc47bf51b06fc8a467
          9714e092ac2a33bc9bab0c62e9ace573
          3fc806f7fdf20755bc6fac01bd0d8c86
          fc9ea0c4c32531bc098132f634994c71
          2f08a61ab58af71a498333fa3b4604a0
          d26d285287cf63ffc2f2e9cd8b939270
          ce78de1891b10c24bb6d08910d81a3d9
          1a814b6ad445ef51298d625a4f4950c7
          8d4127f5138748415d9dc678068af6a8
          a38d7132b9defea6c89ace62391eeb57
          6f9ca12902af4b14d25b93e74a57988d
          faa5adfbf1022ce65fa909576e93df43
          e1aac4baf7a7dfd4b633453e0f5fc364
          cd4c1afd502e3e603895adc867c464fc
          de7251b793eff00fb207a0eee24177c5
          6493d9645968d25443a7bf01ccfb2136
          7a30fac0912f259310128a26b84bfab1
          3bcec60b58b88c4515e10f76af85f4fa
          93dfdf0013024ae5877bdf30883ed436
          fd6bd3c66503a0a142bcdd34f9c22f91
          8335775d256771c01989cbf1442d2cf8
          ac1176cd29cf792e6965ee936f05c18a
          6a79836cf56255c9865e45086206fae2
          784f40a9ddbe25409cd68f9fcacac82c
          307f8eff4a32d2b823faad2decd0d2ee
          f21600d75621253ed14e7e4f5606d4d9
          189c1bf5286214c54ddfcad6d256d1de
          cace6811571d9c29b77e089c3c3d44f2
          17e0c61cd3044e1da61480a180702236
          a71de38cacaa3a3240cc7289da874213
          43d6156f57c1a3bf858a905219bae445
          66a2b2d42bb6ed9d018564f06b8e8f28
          88c7243619e7d80e5ccf100904132435
          93818ddf5a70310818e741ce5ce067f6
          393c30caaaf0c4f0314ba3c38c13f63e
          eea17f7001343fb794b04d3fb8a33be5
          7e17e9d5f27c558a4f414daeceb3660b
          3631bdb68856825b51e0b4c3273766f4
          430f6b10170a3f9f1bc5a7f84dd8e948
          002849f3f32a2adfb7829afba84f2400
          8f19a1500f3a002be79737c9f66aae73
          afe1a0413151cb4c52f76bc41930f3ef
          5eaaedb4907b1320ea4ad42fe35a25a6
          79b8cf1c4fc0a9b29561f5d7e7322094
          7126d6be494165dafa0362c65067ecce
          862a03bc38ccd59ff156b4cbdc974075
          8bea4d5f3884117e71fc9f0183163717
        ].to_set.freeze

        def on_send(node)
          first_argument, = node.arguments
          expected_name = ancestor_method_name(node)
          return if first_argument.type == :sym && first_argument.value == expected_name
          return if LEGACY_EVENT_NAMES.include?(Digest::MD5.hexdigest(expected_name.to_s))
          add_offense(
            first_argument,
            location: :expression,
            message: "Event name must match the method name, expected `:#{expected_name}`",
          )
        end

        private

        def ancestor_method_name(node)
          node.each_ancestor(:def).first.method_name
        end
      end
    end
  end
end
