"use strict";importScripts("AcuantImageService.min.js"),AcuantImageModule().then((e=>{let r=e.addFunction(i,"viiiii"),t=e.addFunction(a,"viiiiiiiii");function i(r,t,i,a,n){let c={func:"crop"};if(i>=0){const o=new ArrayBuffer(t);let s=new Uint8Array(o);s.set(e.HEAPU8.subarray(r,r+t),0),c.imgData=s,c.width=i,c.height=a,c.type=n}else switch(i){case-1:c.error="Runtime error.";break;case-2:c.error="Detect (for cropping) did not return OK";break;case-3:c.error="Crop did not return OK";break;default:c.error="Unknown Error Occured"}c&&c.imgData&&c.imgData.buffer?postMessage(c,[c.imgData.buffer]):postMessage(c)}function a(e,r,t,i,a,n,c,o,s){let u={func:"detect"};if(r>=0)u.type=e,u.x1=r,u.y1=t,u.x2=i,u.y2=a,u.x3=n,u.y3=c,u.x4=o,u.y4=s;else switch(r){case-1:u.error="Runtime error.";break;case-2:u.error="Detect did not return OK";break;default:u.error="Unknown Error Occured"}postMessage(u)}function n(r){null!=r&&(e._free(r),r=null)}function c(r){var t=e._malloc(r.length*r.BYTES_PER_ELEMENT);return e.HEAPU8.set(r,t),t}onmessage=o=>{if(o&&o.data){let s=o.data;if("crop"===s.func){let t=s.data;if(t.imgData&&t.width&&t.height){let i=c(t.imgData);e.ccall("acuantCrop",null,["number","number","number","number"],[i,t.width,t.height,r]),n(i)}else console.error("missing params"),i(-1,-1,-1,-1)}else if("detect"===s.func){let r=s.data;if(r.imgData&&r.width&&r.height){let i=c(r.imgData);e.ccall("acuantDetect",null,["number","number","number","number"],[i,r.width,r.height,t]),n(i)}else console.error("missing params"),a(-1,-1,-1,-1,-1,-1,-1,-1,-1)}else console.error("called with no func specified")}},postMessage({imageWorker:"started"})}));