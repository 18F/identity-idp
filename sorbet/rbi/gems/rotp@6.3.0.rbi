# typed: true

# DO NOT EDIT MANUALLY
# This is an autogenerated file for types exported from the `rotp` gem.
# Please instead update this file by running `bin/tapioca gem rotp`.


# source://rotp//lib/rotp/base32.rb#3
module ROTP; end

# source://rotp//lib/rotp/base32.rb#4
class ROTP::Base32
  class << self
    # source://rotp//lib/rotp/base32.rb#12
    def decode(str); end

    # source://rotp//lib/rotp/base32.rb#31
    def encode(b); end

    # Defaults to 160 bit long secret (meaning a 32 character long base32 secret)
    #
    # source://rotp//lib/rotp/base32.rb#58
    def random(byte_length = T.unsafe(nil)); end

    # Prevent breaking changes
    #
    # source://rotp//lib/rotp/base32.rb#64
    def random_base32(str_len = T.unsafe(nil)); end

    private

    # source://rotp//lib/rotp/base32.rb#71
    def decode_quint(q); end
  end
end

# source://rotp//lib/rotp/base32.rb#5
class ROTP::Base32::Base32Error < ::RuntimeError; end

# source://rotp//lib/rotp/base32.rb#6
ROTP::Base32::CHARS = T.let(T.unsafe(nil), Array)

# source://rotp//lib/rotp/base32.rb#8
ROTP::Base32::MASK = T.let(T.unsafe(nil), Integer)

# source://rotp//lib/rotp/base32.rb#7
ROTP::Base32::SHIFT = T.let(T.unsafe(nil), Integer)

# source://rotp//lib/rotp/totp.rb#2
ROTP::DEFAULT_INTERVAL = T.let(T.unsafe(nil), Integer)

# source://rotp//lib/rotp/hotp.rb#2
class ROTP::HOTP < ::ROTP::OTP
  # Generates the OTP for the given count
  #
  # @param count [Integer] counter
  #
  # source://rotp//lib/rotp/hotp.rb#6
  def at(count); end

  # Returns the provisioning URI for the OTP
  # This can then be encoded in a QR Code and used
  # to provision the Google Authenticator app
  #
  # @param name [String] of the account
  # @param initial_count [Integer] starting counter value, defaults to 0
  # @return [String] provisioning uri
  #
  # source://rotp//lib/rotp/hotp.rb#27
  def provisioning_uri(name = T.unsafe(nil), initial_count = T.unsafe(nil)); end

  # Verifies the OTP passed in against the current time OTP
  #
  # @param otp [String/Integer] the OTP to check against
  # @param counter [Integer] the counter of the OTP
  # @param retries [Integer] number of counters to incrementally retry
  #
  # source://rotp//lib/rotp/hotp.rb#14
  def verify(otp, counter, retries: T.unsafe(nil)); end
end

# source://rotp//lib/rotp/otp.rb#2
class ROTP::OTP
  # @option options
  # @option options
  # @option options
  # @option options
  # @option options
  # @param secret [String] in the form of base32
  # @param options [Hash] a customizable set of options
  # @return [OTP] a new instance of OTP
  #
  # source://rotp//lib/rotp/otp.rb#23
  def initialize(s, options = T.unsafe(nil)); end

  # Returns the value of attribute digest.
  #
  # source://rotp//lib/rotp/otp.rb#3
  def digest; end

  # Returns the value of attribute digits.
  #
  # source://rotp//lib/rotp/otp.rb#3
  def digits; end

  # Usually either the counter, or the computed integer
  # based on the Unix timestamp
  #
  # @param input [Integer] the number used seed the HMAC
  #
  # source://rotp//lib/rotp/otp.rb#35
  def generate_otp(input); end

  # Returns the value of attribute issuer.
  #
  # source://rotp//lib/rotp/otp.rb#3
  def issuer; end

  # Returns the value of attribute name.
  #
  # source://rotp//lib/rotp/otp.rb#3
  def name; end

  # Returns the value of attribute provisioning_params.
  #
  # source://rotp//lib/rotp/otp.rb#3
  def provisioning_params; end

  # Returns the value of attribute secret.
  #
  # source://rotp//lib/rotp/otp.rb#3
  def secret; end

  private

  # source://rotp//lib/rotp/otp.rb#60
  def byte_secret; end

  # Turns an integer to the OATH specified
  # bytestring, which is fed to the HMAC
  # along with the secret
  #
  # source://rotp//lib/rotp/otp.rb#68
  def int_to_bytestring(int, padding = T.unsafe(nil)); end

  # constant-time compare the strings
  #
  # source://rotp//lib/rotp/otp.rb#82
  def time_constant_compare(a, b); end

  # @raise [ArgumentError]
  #
  # source://rotp//lib/rotp/otp.rb#53
  def verify(input, generated); end
end

# source://rotp//lib/rotp/otp.rb#4
ROTP::OTP::DEFAULT_DIGITS = T.let(T.unsafe(nil), Integer)

# https://github.com/google/google-authenticator/wiki/Key-Uri-Format
#
# source://rotp//lib/rotp/otp/uri.rb#4
class ROTP::OTP::URI
  # @return [URI] a new instance of URI
  #
  # source://rotp//lib/rotp/otp/uri.rb#5
  def initialize(otp, account_name: T.unsafe(nil), counter: T.unsafe(nil)); end

  # source://rotp//lib/rotp/otp/uri.rb#11
  def to_s; end

  private

  # source://rotp//lib/rotp/otp/uri.rb#17
  def algorithm; end

  # source://rotp//lib/rotp/otp/uri.rb#23
  def counter; end

  # source://rotp//lib/rotp/otp/uri.rb#30
  def digits; end

  # source://rotp//lib/rotp/otp/uri.rb#36
  def issuer; end

  # source://rotp//lib/rotp/otp/uri.rb#40
  def label; end

  # source://rotp//lib/rotp/otp/uri.rb#48
  def parameters; end

  # source://rotp//lib/rotp/otp/uri.rb#63
  def period; end

  # source://rotp//lib/rotp/otp/uri.rb#70
  def type; end
end

# source://rotp//lib/rotp/totp.rb#3
class ROTP::TOTP < ::ROTP::OTP
  # @option options
  # @param options [Hash] a customizable set of options
  # @return [TOTP] a new instance of TOTP
  #
  # source://rotp//lib/rotp/totp.rb#8
  def initialize(s, options = T.unsafe(nil)); end

  # Accepts either a Unix timestamp integer or a Time object.
  # Time objects will be adjusted to UTC automatically
  #
  # @param time [Time/Integer] the time to generate an OTP for, integer unix timestamp or Time object
  #
  # source://rotp//lib/rotp/totp.rb#17
  def at(time); end

  # Returns the value of attribute interval.
  #
  # source://rotp//lib/rotp/totp.rb#4
  def interval; end

  # Returns the value of attribute issuer.
  #
  # source://rotp//lib/rotp/totp.rb#4
  def issuer; end

  # Generate the current time OTP
  #
  # @return [Integer] the OTP as an integer
  #
  # source://rotp//lib/rotp/totp.rb#23
  def now; end

  # Returns the provisioning URI for the OTP
  # This can then be encoded in a QR Code and used
  # to provision the Google Authenticator app
  #
  # @param name [String] of the account
  # @return [String] provisioning URI
  #
  # source://rotp//lib/rotp/totp.rb#56
  def provisioning_uri(name = T.unsafe(nil)); end

  # Verifies the OTP passed in against the current time OTP
  # and adjacent intervals up to +drift+.  Excludes OTPs
  # from `after` and earlier.  Returns time value of
  # matching OTP code for use in subsequent call.
  #
  # @param otp [String] the one time password to verify
  # @param drift_behind [Integer] how many seconds to look back
  # @param drift_ahead [Integer] how many seconds to look ahead
  # @param after [Integer] prevent token reuse, last login timestamp
  # @param at [Time] time at which to generate and verify a particular
  #   otp. default Time.now
  # @return [Integer, nil] the last successful timestamp
  #   interval
  #
  # source://rotp//lib/rotp/totp.rb#39
  def verify(otp, drift_ahead: T.unsafe(nil), drift_behind: T.unsafe(nil), after: T.unsafe(nil), at: T.unsafe(nil)); end

  private

  # Get back an array of timecodes for a period
  #
  # source://rotp//lib/rotp/totp.rb#63
  def get_timecodes(at, drift_behind, drift_ahead); end

  # source://rotp//lib/rotp/totp.rb#77
  def timecode(time); end

  # Ensure UTC int
  #
  # source://rotp//lib/rotp/totp.rb#71
  def timeint(time); end
end
