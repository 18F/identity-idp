import getAuthenticatorDataFlags from './get-authenticator-data-flags';

describe('getAuthenticatorDataFlags', () => {
  const authenticatorData = Uint8Array.from([
    73, 150, 13, 229, 136, 14, 140, 104, 116, 52, 23, 15, 100, 118, 96, 91, 143, 228, 174, 185, 162,
    134, 50, 199, 153, 92, 243, 186, 131, 29, 151, 99, 65, 0, 0, 0, 0, 173, 206, 0, 2, 53, 188, 198,
    10, 100, 139, 11, 37, 241, 240, 85, 3, 0, 32, 169, 49, 66, 252, 224, 54, 15, 214, 228, 6, 10,
    85, 78, 208, 77, 34, 39, 214, 145, 170, 65, 32, 238, 254, 195, 95, 57, 111, 190, 230, 120, 66,
    165, 1, 2, 3, 38, 32, 1, 33, 88, 32, 190, 188, 238, 23, 175, 12, 47, 114, 213, 20, 157, 44, 97,
    235, 85, 193, 177, 166, 8, 167, 4, 70, 56, 13, 28, 128, 215, 115, 131, 35, 104, 80, 34, 88, 32,
    246, 201, 51, 10, 198, 109, 109, 163, 114, 35, 161, 239, 168, 132, 109, 247, 224, 48, 188, 131,
    225, 190, 13, 223, 243, 75, 174, 252, 212, 215, 183, 9,
  ]).buffer;

  it('returns flags from a credential', () => {
    expect(getAuthenticatorDataFlags(authenticatorData)).to.deep.equal({
      up: true,
      uv: false,
      be: false,
      bs: false,
      at: true,
      ed: false,
    });
  });
});